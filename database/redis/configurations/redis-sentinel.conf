# Redis Sentinel Configuration for TicketToken Platform
# Phase 1: Minimal Working Configuration

# Sentinel port
port 26379

# Bind to localhost
bind 127.0.0.1

# Monitor Redis master
sentinel monitor tickettoken-master 127.0.0.1 6379 2

# ============================================
# PHASE 2: HIGH AVAILABILITY SETTINGS
# ============================================

# Master considered down after 5 seconds
sentinel down-after-milliseconds tickettoken-master 5000

# Failover timeout (60 seconds)
sentinel failover-timeout tickettoken-master 60000

# Parallel syncs during failover
sentinel parallel-syncs tickettoken-master 1

# ============================================
# PHASE 3: PRODUCTION FEATURES
# ============================================

# Deny dangerous commands
sentinel deny-scripts-reconfig yes

# Working directory
dir /var/lib/redis/sentinel

# Logging
logfile /var/log/redis/sentinel.log
loglevel notice

# Authentication (uncomment to enable)
# requirepass your_sentinel_password
# sentinel auth-pass tickettoken-master your_redis_password

# ============================================
# PHASE 4: MULTI-SENTINEL SETUP
# ============================================

# For 3-sentinel setup (recommended minimum):
# Sentinel 1: Use this config as-is on port 26379
# Sentinel 2: Copy this file, change port to 26380
# Sentinel 3: Copy this file, change port to 26381

# Notification script (optional)
# sentinel notification-script tickettoken-master /opt/tickettoken/scripts/notify.sh

# Client reconfiguration script (optional)  
# sentinel client-reconfig-script tickettoken-master /opt/tickettoken/scripts/reconfig.sh

# ============================================
# TESTING COMMANDS
# ============================================
# Start Sentinel:
#   redis-sentinel /path/to/redis-sentinel.conf
#
# Connect to Sentinel:
#   redis-cli -p 26379
#
# Useful Sentinel commands:
#   SENTINEL masters
#   SENTINEL slaves tickettoken-master  
#   SENTINEL get-master-addr-by-name tickettoken-master
#   SENTINEL failover tickettoken-master (force failover)
