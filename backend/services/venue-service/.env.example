# =============================================================================
# VENUE-SERVICE ENVIRONMENT CONFIGURATION
# =============================================================================
# Service: venue-service
# Port: 3002
# Last Updated: November 13, 2025
#
# IMPORTANT: Never commit real secrets to version control!
# Copy this file to .env and fill in appropriate values.
# =============================================================================

# =============================================================================
# CORE SERVICE CONFIGURATION (REQUIRED)
# =============================================================================
# These variables control basic service behavior and MUST be set

# Environment: development, staging, or production
# Affects logging, error handling, and feature availability
NODE_ENV=development

# HTTP server configuration
# Port the service listens on (default: 3002)
PORT=3002
HOST=0.0.0.0

# Service identifier for logging and monitoring
SERVICE_NAME=venue-service

# =============================================================================
# DATABASE CONFIGURATION (REQUIRED)
# =============================================================================
# PostgreSQL database connection settings
# All database variables are REQUIRED for service startup

# Database server hostname or IP address
DB_HOST=localhost

# Database server port
# Standard PostgreSQL: 5432
# With PgBouncer: 6432 (connection pooling)
DB_PORT=5432

# Database credentials
# SECURITY: Never use default passwords in production
DB_USER=postgres
DB_PASSWORD=<CHANGE_ME_STRONG_PASSWORD>

# Database name
# Must exist before service starts
DB_NAME=tickettoken_db

# Connection string (auto-generated from above values)
# Format: postgresql://user:password@host:port/database
DATABASE_URL=postgresql://${DB_USER}:${DB_PASSWORD}@${DB_HOST}:${DB_PORT}/${DB_NAME}

# Connection Pool Settings
# Adjust based on expected load and database server capacity
DB_POOL_MIN=2           # Minimum idle connections
DB_POOL_MAX=10          # Maximum total connections
DB_IDLE_TIMEOUT=30000   # Close idle connections after 30s

# =============================================================================
# CACHE CONFIGURATION (REQUIRED)
# =============================================================================
# Redis configuration for caching and session storage
# All Redis variables are REQUIRED for service startup

# Redis server hostname or IP address
REDIS_HOST=localhost

# Redis server port (default: 6379)
REDIS_PORT=6379

# Redis authentication password
# Leave empty if Redis AUTH is disabled (not recommended for production)
REDIS_PASSWORD=

# Redis database number (0-15, default: 0)
# Use different numbers to isolate data between services/environments
REDIS_DB=0

# Connection string (auto-generated from above values)
REDIS_URL=redis://:${REDIS_PASSWORD}@${REDIS_HOST}:${REDIS_PORT}/${REDIS_DB}

# Cache TTL settings (in seconds)
CACHE_TTL_DEFAULT=300        # 5 minutes for general data
CACHE_TTL_VENUES=600         # 10 minutes for venue data
CACHE_TTL_SETTINGS=3600      # 1 hour for venue settings

# =============================================================================
# SECURITY & AUTHENTICATION (REQUIRED - CRITICAL)
# =============================================================================

# ⚠️  CRITICAL SECURITY REQUIREMENT ⚠️
# JWT_ACCESS_SECRET is REQUIRED and MUST be set
# Service will REFUSE TO START if this is missing
# NEVER commit real secrets to version control
# NEVER use default/example values in production
#
# Generate a secure secret:
#   openssl rand -base64 32
#
# Example format (DO NOT USE THIS EXAMPLE):
#   JWT_ACCESS_SECRET=dGhpc0lzQW5FeGFtcGxlU2VjcmV0S2V5RG9Ob3RVc2U=
JWT_ACCESS_SECRET=

# Legacy JWT secret (for backward compatibility)
# Will be phased out in future versions
JWT_SECRET=<CHANGE_TO_256_BIT_SECRET>

# JWT token expiration settings
JWT_EXPIRES_IN=15m              # Access token: 15 minutes
JWT_REFRESH_EXPIRES_IN=7d       # Refresh token: 7 days

# JWT algorithm and claims
JWT_ALGORITHM=HS256             # HS256 (HMAC SHA-256)
JWT_ISSUER=tickettoken          # Token issuer
JWT_AUDIENCE=tickettoken-platform # Target audience

# Encryption key for sensitive data (API keys, secrets)
# Used for field-level encryption of third-party credentials
# Generate with: openssl rand -base64 32
# See docs/ENCRYPTION.md for details
ENCRYPTION_KEY=base64:

# =============================================================================
# MESSAGE QUEUE (OPTIONAL)
# =============================================================================
# RabbitMQ configuration for event-driven architecture
# Service can operate without RabbitMQ (events won't be published)

# Enable RabbitMQ integration
# Set to 'false' to disable event publishing
ENABLE_RABBITMQ=true

# RabbitMQ connection settings
RABBITMQ_HOST=localhost
RABBITMQ_PORT=5672
RABBITMQ_USER=guest
RABBITMQ_PASSWORD=guest
RABBITMQ_VHOST=/

# RabbitMQ connection string (auto-generated)
RABBITMQ_URL=amqp://${RABBITMQ_USER}:${RABBITMQ_PASSWORD}@${RABBITMQ_HOST}:${RABBITMQ_PORT}${RABBITMQ_VHOST}

# Exchange and queue configuration
RABBITMQ_EXCHANGE=tickettoken.events
RABBITMQ_QUEUE_VENUE_EVENTS=venue.events

# =============================================================================
# SERVICE DISCOVERY (REQUIRED)
# =============================================================================
# Internal service URLs for inter-service communication
# Format: http(s)://hostname:port

# Core services
AUTH_SERVICE_URL=http://localhost:3001
VENUE_SERVICE_URL=http://localhost:3002
EVENT_SERVICE_URL=http://localhost:3003
TICKET_SERVICE_URL=http://localhost:3004
PAYMENT_SERVICE_URL=http://localhost:3005

# Supporting services
ANALYTICS_SERVICE_URL=http://localhost:3007
MARKETPLACE_SERVICE_URL=http://localhost:3008
NOTIFICATION_SERVICE_URL=http://localhost:3009
INTEGRATION_SERVICE_URL=http://localhost:3010
COMPLIANCE_SERVICE_URL=http://localhost:3011
QUEUE_SERVICE_URL=http://localhost:3012
SEARCH_SERVICE_URL=http://localhost:3013
FILE_SERVICE_URL=http://localhost:3014
MONITORING_SERVICE_URL=http://localhost:3015
BLOCKCHAIN_SERVICE_URL=http://localhost:3016
ORDER_SERVICE_URL=http://localhost:3017

# Internal service authentication
# Used for service-to-service API calls
# Generate with: openssl rand -hex 32
INTERNAL_SERVICE_SECRET=

# =============================================================================
# OBSERVABILITY & MONITORING (OPTIONAL)
# =============================================================================

# Logging Configuration
# Controls verbosity and format of application logs
LOG_LEVEL=info              # debug | info | warn | error | fatal
LOG_FORMAT=json             # json (production) | pretty (development)
ENABLE_REQUEST_LOGGING=true # Log all HTTP requests
ENABLE_QUERY_LOGGING=false  # Log database queries (verbose)

# Prometheus Metrics
# Exposes /metrics endpoint for Prometheus scraping
ENABLE_METRICS=true
METRICS_PORT=9090           # Separate port for metrics endpoint
METRICS_PATH=/metrics       # Default metrics path

# OpenTelemetry (Distributed Tracing)
# Traces requests across services for performance analysis
ENABLE_TRACING=true
OTEL_SERVICE_NAME=${SERVICE_NAME}
OTEL_EXPORTER_OTLP_ENDPOINT=http://localhost:4318
OTEL_TRACES_SAMPLER=parentbased_traceidratio
OTEL_TRACES_SAMPLER_ARG=0.1  # Sample 10% of traces

# Health Check Configuration
HEALTH_CHECK_PATH=/health
HEALTH_CHECK_FULL_PATH=/health/full

# =============================================================================
# RATE LIMITING & SECURITY (OPTIONAL)
# =============================================================================

# API Rate Limiting
# Protects against abuse and DoS attacks
ENABLE_RATE_LIMITING=true
RATE_LIMIT_WINDOW_MS=60000      # Time window: 1 minute
RATE_LIMIT_MAX_REQUESTS=100     # Max requests per window per IP
RATE_LIMIT_SKIP_SUCCESSFUL_REQUESTS=false

# CORS Configuration
# Controls which origins can access the API
CORS_ORIGIN=*                   # Allowed origins (* = all, or comma-separated list)
CORS_CREDENTIALS=true           # Allow credentials in CORS requests

# Security Headers (Helmet)
ENABLE_HELMET=true              # Enable security headers middleware

# Request Size Limits
MAX_REQUEST_BODY_SIZE=1mb       # Maximum request body size
MAX_URL_LENGTH=2048             # Maximum URL length

# =============================================================================
# EXTERNAL INTEGRATIONS (OPTIONAL)
# =============================================================================
# EXTERNAL INTEGRATIONS (OPTIONAL)
# =============================================================================
# Payment provider integrations, analytics services, verification services

# Stripe integration (payment processing)
STRIPE_SECRET_KEY=
STRIPE_PUBLISHABLE_KEY=
STRIPE_WEBHOOK_SECRET=

# Plaid integration (bank account verification)
# Used for verifying venue bank accounts for payouts
# Get credentials from: https://dashboard.plaid.com/
PLAID_CLIENT_ID=
PLAID_SECRET=
PLAID_ENV=sandbox  # Options: sandbox, development, production

# Compliance & Notifications
# Email address for compliance team notifications
COMPLIANCE_TEAM_EMAIL=compliance@tickettoken.com

# External Verification Services
# Enable/disable external verification integrations
# If disabled, falls back to manual review workflow
ENABLE_STRIPE_IDENTITY=false   # Stripe Identity for document verification
ENABLE_PLAID_VERIFICATION=false  # Plaid for bank account verification
ENABLE_TAX_VERIFICATION=true    # Always enabled (uses manual review)
ENABLE_BUSINESS_VERIFICATION=true  # Always enabled (uses manual review)

# Square (Payment Processing)
# Get keys from: https://developer.squareup.com/apps
SQUARE_APPLICATION_ID=
SQUARE_ACCESS_TOKEN=
SQUARE_LOCATION_ID=

# Twilio (SMS Notifications)
# Get credentials from: https://console.twilio.com
TWILIO_ACCOUNT_SID=
TWILIO_AUTH_TOKEN=
TWILIO_PHONE_NUMBER=

# Mailchimp (Email Marketing)
# Get API key from: https://mailchimp.com/account/api/
MAILCHIMP_API_KEY=
MAILCHIMP_LIST_ID=

# =============================================================================
# FEATURE FLAGS (OPTIONAL)
# =============================================================================
# Toggle features on/off without code changes

# Core Features
ENABLE_VENUE_CREATION=true
ENABLE_STAFF_MANAGEMENT=true
ENABLE_INTEGRATIONS=true
ENABLE_ANALYTICS=true
ENABLE_COMPLIANCE=true

# Experimental Features
ENABLE_AI_SUGGESTIONS=false
ENABLE_ADVANCED_ANALYTICS=false

# Maintenance Mode
MAINTENANCE_MODE=false
MAINTENANCE_MESSAGE="Service temporarily unavailable for maintenance"

# =============================================================================
# DEVELOPMENT & TESTING (OPTIONAL)
# =============================================================================
# Settings for development and testing environments only

# Mock External Services
# Useful for testing without real API keys
MOCK_STRIPE=false
MOCK_SQUARE=false
MOCK_TWILIO=false

# Seed Data
# Auto-populate database with test data on startup
ENABLE_SEED_DATA=false
SEED_DATA_PATH=./seeds/development

# Debug Options
DEBUG_SQL=false                 # Log all SQL queries
DEBUG_CACHE=false               # Log all cache operations
DEBUG_AUTH=false                # Log authentication decisions

# Test Configuration
TEST_DATABASE_NAME=tickettoken_test
TEST_REDIS_DB=15               # Use separate Redis DB for tests

# =============================================================================
# PERFORMANCE TUNING (OPTIONAL)
# =============================================================================
# Advanced performance settings - modify with caution

# Node.js Memory
NODE_OPTIONS=--max-old-space-size=2048  # Increase heap size to 2GB

# Connection Timeouts
HTTP_TIMEOUT=30000              # HTTP request timeout: 30s
DB_QUERY_TIMEOUT=10000          # Database query timeout: 10s
REDIS_CONNECT_TIMEOUT=5000      # Redis connection timeout: 5s

# Concurrent Operations
MAX_CONCURRENT_DB_QUERIES=20
MAX_CONCURRENT_API_CALLS=10

# Cache Prewarming
ENABLE_CACHE_PREWARM=false
CACHE_PREWARM_ON_STARTUP=false

# =============================================================================
# ENVIRONMENT-SPECIFIC OVERRIDES
# =============================================================================
# Add custom configuration below based on NODE_ENV
# These override the defaults above

# Development overrides
# (Add development-specific settings here)

# Staging overrides
# (Add staging-specific settings here)

# Production overrides
# (Add production-specific settings here)

# =============================================================================
# END OF CONFIGURATION
# =============================================================================
# For more information, see:
# - README.md - Service overview
# - docs/CONFIGURATION.md - Detailed configuration guide
# - docs/ENCRYPTION.md - Encryption and key management
# - docs/DEPLOYMENT.md - Deployment procedures
# =============================================================================
