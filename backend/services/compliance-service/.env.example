# =============================================================================
# Compliance Service Environment Configuration
# AUDIT FIX: DOC-M1 - Environment variable descriptions
# =============================================================================
# Copy this file to .env and fill in the values
# NEVER commit .env files to version control

# =============================================================================
# SERVICE CONFIGURATION
# =============================================================================

# Service name for logging and tracing
SERVICE_NAME=compliance-service

# Environment (development, staging, production)
NODE_ENV=development

# Port the service listens on
# Default: 3008
PORT=3008

# Log level (trace, debug, info, warn, error, fatal)
# Default: info (production should use 'warn' or 'error')
LOG_LEVEL=info

# =============================================================================
# DATABASE CONFIGURATION
# =============================================================================

# PostgreSQL connection string
# Format: postgresql://user:password@host:port/database
# REQUIRED in production - no fallback allowed
DATABASE_URL=postgresql://postgres:password@localhost:5432/compliance

# Database pool configuration
# Minimum connections to keep open
DB_POOL_MIN=2

# Maximum connections allowed
DB_POOL_MAX=10

# Acquire timeout in milliseconds
# How long to wait for a connection from the pool
DB_ACQUIRE_TIMEOUT=10000

# Statement timeout in milliseconds
# Maximum time a query can run
DB_STATEMENT_TIMEOUT=30000

# =============================================================================
# REDIS CONFIGURATION
# =============================================================================

# Redis connection URL
# Format: redis://[:password@]host:port[/db]
# REQUIRED for rate limiting, caching, and distributed locks
REDIS_URL=redis://localhost:6379

# Enable Redis TLS (true/false)
# Should be 'true' in production
REDIS_TLS_ENABLED=false

# =============================================================================
# AUTHENTICATION & SECURITY
# =============================================================================

# JWT secret for token verification
# REQUIRED - minimum 32 characters for security
# In production, use AWS Secrets Manager or Vault
JWT_SECRET=your-jwt-secret-at-least-32-characters-long

# JWT issuer for token validation
# Should match the auth-service issuer
JWT_ISSUER=tickettoken-auth

# JWT audience for token validation
JWT_AUDIENCE=tickettoken-api

# Webhook secret for external webhook verification (e.g., Stripe)
# REQUIRED - minimum 16 characters
WEBHOOK_SECRET=your-webhook-secret-16-chars

# Stripe webhook signing secret
# Format: whsec_xxx
STRIPE_WEBHOOK_SECRET=whsec_your_stripe_webhook_secret

# Internal service-to-service authentication token
# Used by other microservices to call this service
INTERNAL_SERVICE_TOKEN=your-internal-service-token

# =============================================================================
# SECRETS MANAGEMENT
# =============================================================================

# Secrets provider (env, aws, vault)
# env: Use environment variables (development only)
# aws: Use AWS Secrets Manager
# vault: Use HashiCorp Vault
SECRETS_PROVIDER=env

# AWS Secrets Manager configuration (if SECRETS_PROVIDER=aws)
AWS_REGION=us-east-1
AWS_SECRET_NAME=compliance-service/secrets

# HashiCorp Vault configuration (if SECRETS_PROVIDER=vault)
VAULT_ADDR=http://localhost:8200
VAULT_TOKEN=your-vault-token
VAULT_PATH=secret/data/compliance-service

# =============================================================================
# EXTERNAL SERVICE URLS
# =============================================================================

# Auth service URL for user validation
AUTH_SERVICE_URL=http://localhost:3001

# User service URL for user data
USER_SERVICE_URL=http://localhost:3002

# Event service URL for event data
EVENT_SERVICE_URL=http://localhost:3003

# Notification service URL for sending notifications
NOTIFICATION_SERVICE_URL=http://localhost:3007

# =============================================================================
# OFAC/SDN SCREENING
# =============================================================================

# OFAC API endpoint for sanctions screening
OFAC_API_URL=https://api.ofac.treasury.gov

# OFAC API key (if required)
OFAC_API_KEY=

# Enable OFAC screening (true/false)
OFAC_SCREENING_ENABLED=true

# =============================================================================
# TAX/1099 CONFIGURATION
# =============================================================================

# IRS 1099 reporting threshold in cents
# Default: $600 = 60000 cents
IRS_1099_THRESHOLD=60000

# Enable automatic 1099 generation
TAX_AUTO_GENERATE=true

# Tax year for 1099 processing
TAX_YEAR=2026

# =============================================================================
# GDPR CONFIGURATION
# =============================================================================

# Data export expiration in hours
# How long an export download link is valid
GDPR_EXPORT_EXPIRATION_HOURS=24

# Deletion grace period in days
# Time before permanent deletion after request
GDPR_DELETION_GRACE_PERIOD_DAYS=30

# Activity log retention in days
# How long to keep user activity logs
GDPR_ACTIVITY_LOG_RETENTION_DAYS=365

# =============================================================================
# RATE LIMITING
# =============================================================================

# Default rate limit (requests per minute)
RATE_LIMIT_DEFAULT=100

# GDPR export rate limit (requests per hour)
RATE_LIMIT_GDPR_EXPORT=5

# Risk assessment rate limit (requests per minute)
RATE_LIMIT_RISK_ASSESSMENT=50

# =============================================================================
# FEATURE FLAGS
# =============================================================================

# Enable detailed health check responses
FEATURE_DETAILED_HEALTH=true

# Enable metrics endpoint
FEATURE_METRICS_ENABLED=true

# Enable request tracing
FEATURE_TRACING_ENABLED=true

# =============================================================================
# OBSERVABILITY
# =============================================================================

# OpenTelemetry collector endpoint
OTEL_EXPORTER_OTLP_ENDPOINT=http://localhost:4317

# Prometheus metrics path
METRICS_PATH=/metrics

# =============================================================================
# GRACEFUL SHUTDOWN
# =============================================================================

# Shutdown delay in milliseconds
# Time to wait for load balancer to drain connections
SHUTDOWN_DELAY_MS=5000

# Shutdown timeout in milliseconds
# Maximum time to wait for graceful shutdown
SHUTDOWN_TIMEOUT_MS=30000
