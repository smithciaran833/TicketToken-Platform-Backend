# =================================================================
# Notification Service Environment Configuration
# =================================================================
# Copy this file to .env and fill in your values
# DO NOT commit .env to version control
# =================================================================

# -----------------------------------------------------------------
# Application
# -----------------------------------------------------------------
NODE_ENV=development
PORT=3006
SERVICE_NAME=notification-service
LOG_LEVEL=info

# -----------------------------------------------------------------
# Database - PostgreSQL
# -----------------------------------------------------------------
DATABASE_URL=postgresql://postgres:postgres@localhost:5432/notification_service
DATABASE_POOL_MIN=2
DATABASE_POOL_MAX=10

# -----------------------------------------------------------------
# Redis
# -----------------------------------------------------------------
REDIS_URL=redis://localhost:6379
REDIS_TLS_ENABLED=false

# -----------------------------------------------------------------
# MongoDB (for notification templates and logs)
# -----------------------------------------------------------------
MONGODB_URI=mongodb://localhost:27017/notifications
MONGODB_DATABASE=notifications

# -----------------------------------------------------------------
# RabbitMQ
# -----------------------------------------------------------------
RABBITMQ_URL=amqp://guest:guest@localhost:5672
# Use amqps:// for TLS connections
# RABBITMQ_URL=amqps://user:password@rabbitmq.example.com:5671

# -----------------------------------------------------------------
# Authentication
# -----------------------------------------------------------------
JWT_SECRET=your-jwt-secret-change-in-production
JWT_ISSUER=tickettoken-platform
JWT_AUDIENCE=notification-service
INTERNAL_SERVICE_SECRET=your-internal-service-secret

# -----------------------------------------------------------------
# SendGrid (Email Provider)
# -----------------------------------------------------------------
SENDGRID_API_KEY=SG.your-sendgrid-api-key
SENDGRID_FROM_EMAIL=notifications@tickettoken.com
SENDGRID_FROM_NAME=TicketToken
SENDGRID_WEBHOOK_VERIFICATION_KEY=your-webhook-verification-key
SENDGRID_TIMEOUT_MS=30000

# -----------------------------------------------------------------
# Twilio (SMS Provider)
# -----------------------------------------------------------------
TWILIO_ACCOUNT_SID=your-twilio-account-sid
TWILIO_AUTH_TOKEN=your-twilio-auth-token
TWILIO_FROM_NUMBER=+1234567890
TWILIO_WEBHOOK_AUTH_TOKEN=your-twilio-webhook-auth-token
TWILIO_TIMEOUT_MS=30000

# -----------------------------------------------------------------
# AWS SES (Alternative Email Provider)
# -----------------------------------------------------------------
AWS_ACCESS_KEY_ID=your-aws-access-key-id
AWS_SECRET_ACCESS_KEY=your-aws-secret-access-key
AWS_REGION=us-east-1
AWS_SES_FROM_EMAIL=notifications@tickettoken.com
AWS_SES_CONFIGURATION_SET=tickettoken-notifications

# -----------------------------------------------------------------
# Feature Flags
# -----------------------------------------------------------------
ENABLE_EMAIL=true
ENABLE_SMS=true
ENABLE_PUSH=false
ENABLE_WEBHOOKS=true

# -----------------------------------------------------------------
# Rate Limiting
# -----------------------------------------------------------------
RATE_LIMIT_ENABLED=true
RATE_LIMIT_WINDOW_MS=60000
RATE_LIMIT_MAX_REQUESTS=100
RATE_LIMIT_WEBHOOK_MAX=1000

# -----------------------------------------------------------------
# Data Retention (Days)
# -----------------------------------------------------------------
RETENTION_NOTIFICATION_LOGS_DAYS=90
RETENTION_WEBHOOK_EVENTS_DAYS=30
RETENTION_DELIVERY_STATUS_DAYS=90
RETENTION_ANALYTICS_DAYS=365
RETENTION_FAILED_NOTIFICATIONS_DAYS=30
RETENTION_CONSENT_HISTORY_DAYS=2555
RETENTION_JOB_HISTORY_DAYS=14

# -----------------------------------------------------------------
# Monitoring & Observability
# -----------------------------------------------------------------
METRICS_ENABLED=true
TRACING_ENABLED=true
TRACING_SAMPLE_RATE=0.1

# OpenTelemetry (optional)
OTEL_SERVICE_NAME=notification-service
OTEL_EXPORTER_OTLP_ENDPOINT=http://localhost:4317

# -----------------------------------------------------------------
# External Services
# -----------------------------------------------------------------
AUTH_SERVICE_URL=http://localhost:3001
USER_SERVICE_URL=http://localhost:3002
EVENT_SERVICE_URL=http://localhost:3003

# -----------------------------------------------------------------
# Security
# -----------------------------------------------------------------
# Allowed CORS origins (comma-separated)
CORS_ORIGINS=http://localhost:3000,http://localhost:8080

# Request body size limit
MAX_BODY_SIZE=10mb

# -----------------------------------------------------------------
# Queue Configuration (BullMQ)
# -----------------------------------------------------------------
QUEUE_NOTIFICATION_CONCURRENCY=10
QUEUE_CAMPAIGN_CONCURRENCY=5
QUEUE_MAX_RETRIES=3
QUEUE_RETRY_DELAY_MS=5000

# -----------------------------------------------------------------
# Testing (only for test environment)
# -----------------------------------------------------------------
# TEST_DATABASE_URL=postgresql://postgres:postgres@localhost:5432/notification_service_test
# TEST_REDIS_URL=redis://localhost:6379/1
