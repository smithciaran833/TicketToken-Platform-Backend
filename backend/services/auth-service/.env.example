# ================================================
# AUTH-SERVICE ENVIRONMENT CONFIGURATION
# ================================================

# ==== REQUIRED: Core Service Configuration ====
NODE_ENV=development                    # development | staging | production
PORT=3001                               # Service port
SERVICE_NAME=auth-service               # Service identifier

# ==== REQUIRED: Database Configuration ====
DB_HOST=localhost                       # Database host
DB_PORT=5432                           # PostgreSQL port (5432) or pgBouncer (6432)
DB_USER=postgres                       # Database user
DB_PASSWORD=<CHANGE_ME>                # Database password
DB_NAME=tickettoken_db                 # Database name
DATABASE_URL=postgresql://${DB_USER}:${DB_PASSWORD}@${DB_HOST}:${DB_PORT}/${DB_NAME}

# ==== REQUIRED: Redis Configuration ====
REDIS_HOST=localhost                   # Redis host
REDIS_PORT=6379                       # Redis port
REDIS_PASSWORD=<REDIS_PASSWORD>       # Redis password (if auth enabled)
REDIS_DB=0                            # Redis database number

# ==== REQUIRED: JWT Configuration (User Tokens) ====
# RS256 uses RSA public/private key pairs for enhanced security
# Generate keys with:
#   openssl genrsa -out ~/tickettoken-secrets/jwt-private.pem 4096
#   openssl rsa -in ~/tickettoken-secrets/jwt-private.pem -pubout -out ~/tickettoken-secrets/jwt-public.pem
JWT_ALGORITHM=RS256
JWT_PRIVATE_KEY_PATH=~/tickettoken-secrets/jwt-private.pem
JWT_PUBLIC_KEY_PATH=~/tickettoken-secrets/jwt-public.pem
# Or provide keys directly (base64 encoded):
# JWT_PRIVATE_KEY=<base64-encoded-private-key>
# JWT_PUBLIC_KEY=<base64-encoded-public-key>
JWT_ACCESS_EXPIRES_IN=15m              # Access token expiration
JWT_REFRESH_EXPIRES_IN=7d              # Refresh token expiration
JWT_ISSUER=tickettoken-auth            # JWT issuer

# ==== REQUIRED (Production): S2S Keys (Service-to-Service Tokens) ====
# SECURITY: Use SEPARATE keys from user JWT keys!
# This limits blast radius if one key is compromised.
# Generate keys with:
#   openssl genrsa -out ~/tickettoken-secrets/s2s-private.pem 4096
#   openssl rsa -in ~/tickettoken-secrets/s2s-private.pem -pubout -out ~/tickettoken-secrets/s2s-public.pem
S2S_PRIVATE_KEY_PATH=~/tickettoken-secrets/s2s-private.pem
S2S_PUBLIC_KEY_PATH=~/tickettoken-secrets/s2s-public.pem
# Or provide keys directly (base64 encoded):
# S2S_PRIVATE_KEY=<base64-encoded-private-key>
# S2S_PUBLIC_KEY=<base64-encoded-public-key>
S2S_TOKEN_EXPIRES_IN=24h               # Service token expiration

# ==== REQUIRED: Security Configuration ====
ENCRYPTION_KEY=<32-character-min-key>  # For encrypting MFA secrets, etc.
BCRYPT_ROUNDS=12                       # Password hashing rounds (10-14)

# ==== REQUIRED: Email Configuration (Resend) ====
RESEND_API_KEY=re_placeholder_key     # Resend API key (get from resend.com)
EMAIL_FROM=TicketToken <noreply@tickettoken.com>

# ==== Optional: OAuth Configuration ====
GOOGLE_CLIENT_ID=
GOOGLE_CLIENT_SECRET=
GOOGLE_REDIRECT_URI=http://localhost:3000/auth/google/callback

GITHUB_CLIENT_ID=
GITHUB_CLIENT_SECRET=
GITHUB_REDIRECT_URI=http://localhost:3000/auth/github/callback

# ==== Optional: MFA Configuration ====
MFA_ISSUER=TicketToken                 # TOTP issuer name
MFA_WINDOW=2                           # TOTP verification window

# ==== Optional: Rate Limiting ====
LOCKOUT_MAX_ATTEMPTS=5                 # Max failed login attempts
LOCKOUT_DURATION_MINUTES=15            # Lockout duration

# ==== Optional: Monitoring & Logging ====
LOG_LEVEL=info                         # trace | debug | info | warn | error
ENABLE_SWAGGER=false                   # Enable Swagger UI

# ==== Optional: Graceful Shutdown ====
LB_DRAIN_DELAY=5                       # Seconds to wait for LB to drain

# ==== Optional: Trusted Proxies ====
TRUSTED_PROXIES=                       # Comma-separated list of trusted proxy IPs

# ==== Service URLs (for service-to-service calls) ====
API_GATEWAY_URL=http://api-gateway:3000
VENUE_SERVICE_URL=http://venue-service:3002
NOTIFICATION_SERVICE_URL=http://notification-service:3008
